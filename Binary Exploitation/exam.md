# Exam

----
![image](https://github.com/anhshidou/AngstromCTF2024/assets/81132394/4105f9c1-fdc9-425e-b391-8991ea6e50dd)

----
Trước tiên mình thử tải file về và xem nó là file gì

![image](https://github.com/anhshidou/AngstromCTF2024/assets/81132394/9e88f901-fc08-412d-becd-7a41e544dcf7)

Chạy thử file

![image](https://github.com/anhshidou/AngstromCTF2024/assets/81132394/467b7257-2254-4720-892e-e1de755fd6bf)

Có vẻ sau đoạn này nó bị rơi vào vòng lặp gì đó. Mình thử mở ida lên và decomply nó về code

![image](https://github.com/anhshidou/AngstromCTF2024/assets/81132394/5dab3845-c820-445a-b781-eeea0282ea62)

Cơ bản code mình sẽ như sau

```
[Start]
   |
   v
[Initialize Variables]
   |
   v
[Print Trust Prompt]
   |
   v
[Read detrust Input]
   |
   v
[detrust >= 0]
 /     \
T       F
/         \
v          v
[Update trust_level]   [Print Trick Message]
   |                   |
   v                   v
[trust_level == threshold]        [End]
 /     \
T       F
/         \
v          v
[Print Cheating Messages] [While Loop: trust_level < threshold]
       |                  /            \
       v                [Print Trustworthiness Prompt]
      [End]             [Read Statement Input]
                        [Check Statement]
                       /         \
                      T           F
                     /             \
                    v               v
[Decrease trust_level]        [Continue Loop]
      |
      v
[Open flag.txt]
      |
      v
[Read File Content]
      |
      v
[Print Exam Instructions]
      |
      v
     [End]

```

Với flowchart như thế này, ta có thể suy ra như sau
* Detrust = -trust_level
* Ta cần trust_level >= max_int
* trust_level sẽ bị giảm 1 giá trị khi nhập đúng cụm từ sau lượt 2

Check string yêu cầu: `I confirm that I am taking this exam between the dates 5/24/2024 and 5/27/2024. I will not disclose any information about any section of this exam.`

Mình test thử với file được cung cấp. Đầu tiên nhập max_int vào

![image](https://github.com/anhshidou/AngstromCTF2024/assets/81132394/f35cd2c3-39c5-4b84-b19f-f43185b6ae0d)

Sau khi nhập xong, ta có thể lợi dụng int overflow để thay đổi `trust_level == max_int`

![image](https://github.com/anhshidou/AngstromCTF2024/assets/81132394/53449200-85b6-4180-b432-edac36685d72)

Vậy là mình có vẻ đã thành công rồi. Giờ test thử trên server của challenge

`nc challs.actf.co 31322`

![image](https://github.com/anhshidou/AngstromCTF2024/assets/81132394/3c5a9be2-cb50-4adb-b7be-c737f98c955c)

Flag: `actf{manifesting_those_fives}`

**--End--**
